/** Version: 5.7.0 (TBD)
 */
!function(){"use strict";var o,a,t,e,n,i,r=tinymce.util.Tools.resolve("tinymce.PluginManager"),u=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils").DOM,d=function(t,e){return t&&t.hasAttribute(e)?t.getAttribute(e):""},l="undefined"!=typeof window?window:Function("return this;")(),c=(o="object",function(t){return n=typeof(e=t),(null===e?"null":"object"==n&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":n)===o;var e,n}),s=Object.prototype.hasOwnProperty,p=(a=function(t,e){return c(t)&&c(e)?p(t,e):e},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0===t.length)throw new Error("Can't merge zero objects");for(var n={},o=0;o<t.length;o++){var i=t[o];for(var r in i)s.call(i,r)&&(n[r]=a(n[r],i[r]))}return n});tinymce.util.Tools.resolve("tinymce.EditorManager");(e=t=t||{})["default"]="wrap",e.floating="floating",e.sliding="sliding",e.scrolling="scrolling",(i=n=n||{}).auto="auto",i.top="top",i.bottom="bottom";var m=tinymce.util.Tools.resolve("tinymce.util.Promise"),g=function(t){var e,n,o,i,r,a,c,l,s=(e=t.selection.getNode())&&"SELECT"!==e.nodeName&&"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName&&(e.children.length&&(e=e.children[e.children.length-1]),"SELECT"!==e.nodeName&&"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName)?null:e;return(t.selection.control=s)?(n=s,o=u.styles.parse(d(n,"style")),i=o.width?o.width:"",r=o.height?o.height:"",a=d(n,"n"),c=d(n,"ln"),l=d(n,"dv"),"SELECT"===n.tagName?{style:{width:i,height:r},option:n.innerHTML.replace(/<\/option><option.*?>/g,",").replace(/<option.*?>/g,"").replace("</option>",""),n:a,ln:c,dv:l}:"TEXTAREA"===n.tagName?{style:{width:i,height:r},option:n.innerHTML,n:a,ln:c,dv:l}:"INPUT"===n.tagName?{style:{width:i,height:r},option:d(n,"value"),n:a,ln:c,dv:l}:void 0):{style:{width:"",height:""},option:"",n:"",ln:"",dv:""}},y=function(t){return{style:{width:t.style.width,height:t.style.height},option:t.option,n:t.n,ln:t.ln,dv:{dv:t.dv}}},h=function(o,t){var r,a,c={type:t,onSubmit:(r=o,a=t,function(i){return function(e){var t=p(y(i.control),e.getData()),n=r.selection.control,o=r.getParam("control_dlg_set");o!==undefined&&(l.console.log(t),o(a,t).then(function(t){l.console.log(t),300!==t.code?200===t.code?(n.setAttribute("n",t.data.n),n.setAttribute("ln",t.data.ln),e.close()):l.alert(t.msg):e.close()})),n.style&&(n.style.width=t.style.width,n.style.height=t.style.height),"SELECT"===n.tagName?""===t.option.trim()?n.innerHTML="":n.innerHTML="<option>"+t.option.replace(/,/g,"</option><option>")+"</option>":"TEXTAREA"===n.tagName?n.innerHTML=t.option:"INPUT"===n.tagName&&n.setAttribute("value",t.option),n.setAttribute("dv",t.dv.dv),o===undefined&&e.close()}}),onChange:function(){return function(t){var e=t.getData();l.console.log(e),"lnk"in e&&"tblStaff"===e.lnk.vcLnkTb&&l.console.log("yes")}}};return{open:function(){var i,r,t,e,n;t=o,e=new m(function(t){t()}),n=g(t),e.then(function(){return{control:n}}).then((i=c,r=o,function(t){var e="select"===i.type?{type:"tabpanel",tabs:[{title:"General",name:"general",items:[{name:"style",type:"sizeinput",constrain:!0},{name:"option",type:"input",label:"Option"}]}]}:{type:"tabpanel",tabs:[{title:"General",name:"general",items:[{name:"style",type:"sizeinput",constrain:!1},{name:"option",type:"input",label:"Value"}]}]},n={title:i.type,size:"normal",body:null,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:y(t.control),onSubmit:i.onSubmit(t),onChange:i.onChange()},o=r.getParam("control_dlg_get");o!==undefined?o(i.type,t.control.n,t.control.ln).then(function(t){return 200===t.code&&(e.tabs.push({title:"Db",name:"db",items:[]}),e.tabs.push({title:"Flow",name:"flow",items:[]}),e.tabs.push({title:"Formula",name:"formula",items:[]}),e.tabs.push({title:"SumTb",name:"sumTb",items:[]}),e.tabs.push({title:"Permission",name:"permission",items:[]}),e.tabs[1].items=t.data[0],e.tabs[2].items=t.data[1],e.tabs[3].items=t.data[2],e.tabs[4].items=t.data[3],e.tabs[5].items=t.data[4],l.console.log(t.data)),n.body=e,n}).then(r.windowManager.open):(n.body=e,r.windowManager.open(n))}))}}},f=function(t){return{select:function(){t.insertContent(t.dom.createHTML("select",{name:"h"}))},input:function(){t.insertContent(t.dom.createHTML("input",{name:"h",type:"text"}))},textarea:function(){t.insertContent('<textarea name="h"></textarea>')},checkbox:function(){t.insertContent(t.dom.createHTML("input",{name:"h",type:"checkbox"}))},radio:function(){t.insertContent(t.dom.createHTML("input",{name:"h",type:"radio"}))},file:function(){t.insertContent(t.dom.createHTML("input",{name:"h",type:"file"}))}}},b=function(t){t.ui.registry.addMenuButton("control",{icon:"control",tooltip:"Control",fetch:function(t){return t("selectInsert inputInsert textareaInsert checkboxInsert radioInsert fileInsert")}}),t.ui.registry.addMenuItem("selectInsert",{icon:"select",text:"Select",onAction:f(t).select}),t.ui.registry.addMenuItem("select",{icon:"select",text:"Select",onAction:h(t,"select").open}),t.ui.registry.addContextMenu("select",{update:function(t){return"SELECT"===t.nodeName?["select"]:[]}}),t.ui.registry.addMenuItem("inputInsert",{icon:"input",text:"Input",onAction:f(t).input}),t.ui.registry.addMenuItem("input",{icon:"input",text:"Input",onAction:h(t,"input").open}),t.ui.registry.addMenuItem("textareaInsert",{icon:"textarea",text:"Textarea",onAction:f(t).textarea}),t.ui.registry.addMenuItem("textarea",{icon:"textarea",text:"Textarea",onAction:h(t,"textarea").open}),t.ui.registry.addContextMenu("textarea",{update:function(t){return"TEXTAREA"===t.nodeName?["textarea"]:[]}}),t.ui.registry.addMenuItem("checkboxInsert",{icon:"checkbox",text:"Checkbox",onAction:f(t).checkbox}),t.ui.registry.addMenuItem("checkbox",{icon:"checkbox",text:"Checkbox",onAction:h(t,"checkbox").open}),t.ui.registry.addMenuItem("radioInsert",{icon:"radio",text:"Radio",onAction:f(t).radio}),t.ui.registry.addMenuItem("radio",{icon:"radio",text:"Radio",onAction:h(t,"radio").open}),t.ui.registry.addMenuItem("fileInsert",{icon:"file",text:"File",onAction:f(t).file}),t.ui.registry.addMenuItem("file",{icon:"file",text:"File",onAction:h(t,"file").open}),t.ui.registry.addContextMenu("input",{update:function(t){return"INPUT"===(i=t).nodeName&&"text"===u.getAttrib(i,"type")?["input"]:"INPUT"===(o=t).nodeName&&"checkbox"===u.getAttrib(o,"type")?["checkbox"]:"INPUT"===(n=t).nodeName&&"radio"===u.getAttrib(n,"type")?["radio"]:"INPUT"===(e=t).nodeName&&"file"===u.getAttrib(e,"type")?["file"]:[];var e,n,o,i}})};r.add("control",function(t){b(t)})}();